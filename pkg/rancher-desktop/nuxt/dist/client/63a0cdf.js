(window.webpackJsonp=window.webpackJsonp||[]).push([[18,59],{1084:function(e,t,n){"use strict";n.r(t);n(26),n(21),n(49),n(42),n(43),n(44),n(45),n(55);var r=n(2),o=n(94),c=n(8),m=(n(27),n(78),n(85),n(50),n(51),n(52),n(37),n(9),n(40),n(25),n(41),n(123),n(22),n(30)),l=n.n(m),d=n(77),h=n(828),f=n(750),v=n(74),w=n(20);function O(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function I(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?O(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):O(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var N={components:{Images:f.default},data:function(){return{settings:v.i,images:[],imageNamespaces:[],supportsNamespaces:!0}},computed:I(I(I({state:function(){return[h.a.STARTED,h.a.DISABLED].includes(this.k8sState)&&this.imageManagerState?"READY":"IMAGE_MANAGER_UNREADY"},rancherImages:function(){return this.images.filter((function(image){return image.imageName.startsWith("rancher/")})).map((function(image){return image.imageName}))},installedExtensionImages:function(){return this.extensions.map((function(image){return image.id}))},protectedImages:function(){return["moby/buildkit","ghcr.io/rancher-sandbox/rancher-desktop/rdx-proxy"].concat(Object(o.a)(this.rancherImages),Object(o.a)(this.installedExtensionImages))}},Object(d.b)("k8sManager",{k8sState:"getK8sState"})),Object(d.b)("imageManager",{imageManagerState:"getImageManagerState"})),Object(d.b)("extensions",{extensions:"list"})),watch:{imageManagerState:{handler:function(e){this.$store.dispatch("page/setHeader",{title:this.t("images.title")}),e&&this.$store.dispatch("page/setAction",{action:"ImagesButtonAdd"})},immediate:!0}},mounted:function(){var e=this;w.a.on("images-changed",(function(t,n){l.a.isEqual(n,e.images)||(e.images=n,e.supportsNamespaces&&0===e.imageNamespaces.length&&w.a.send("images-namespaces-read"))})),w.a.on("images-check-state",(function(t,n){e.$store.dispatch("imageManager/setImageManagerState",n)})),w.a.invoke("images-check-state").then((function(t){e.$store.dispatch("imageManager/setImageManagerState",t)})),w.a.on("settings-update",(function(t,n){e.$data.settings=n,e.checkSelectedNamespace()})),Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.a.invoke("images-mounted",!0);case 2:e.$data.images=t.sent;case 3:case"end":return t.stop()}}),t)})))(),w.a.on("images-namespaces",(function(t,n){e.$data.imageNamespaces=n,e.$data.supportsNamespaces=n.length>0,e.checkSelectedNamespace()})),w.a.send("images-namespaces-read"),w.a.on("settings-read",(function(t,n){e.$data.settings=n})),w.a.send("settings-read"),w.a.on("extensions/changed",this.fetchExtensions),this.$store.dispatch("extensions/fetch")},beforeDestroy:function(){w.a.invoke("images-mounted",!1),w.a.removeAllListeners("images-mounted"),w.a.removeAllListeners("images-changed"),w.a.removeListener("extensions/changed",this.fetchExtensions)},methods:{checkSelectedNamespace:function(){if(this.supportsNamespaces&&0!==this.imageNamespaces.length&&!this.imageNamespaces.includes(this.settings.images.namespace)){var e="k8s.io",t=this.imageNamespaces.includes(e)?e:this.imageNamespaces[0];w.a.invoke("settings-write",{images:{namespace:t}})}},onShowAllImagesChanged:function(e){e!==this.settings.images.showAll&&w.a.invoke("settings-write",{images:{showAll:e}})},onChangeNamespace:function(e){e!==this.settings.images.namespace&&w.a.invoke("settings-write",{images:{namespace:e}})},fetchExtensions:function(){this.$store.dispatch("extensions/fetch")}}},y=N,x=n(24),component=Object(x.a)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("nuxt-child"),e._v(" "),n("Images",{staticClass:"content",attrs:{"data-test":"imagesTable",images:e.images,"image-namespaces":e.imageNamespaces,state:e.state,"show-all":e.settings.images.showAll,"selected-namespace":e.settings.images.namespace,"supports-namespaces":e.supportsNamespaces,"protected-images":e.protectedImages},on:{toggledShowAll:e.onShowAllImagesChanged,switchNamespace:e.onChangeNamespace}})],1)}),[],!1,null,null,null);t.default=component.exports},750:function(e,t,n){"use strict";n.r(t);n(26),n(21),n(49),n(43),n(44),n(45),n(55);var r=n(2),o=n(8),c=(n(27),n(78),n(50),n(51),n(52),n(22),n(37),n(9),n(40),n(25),n(41),n(241),n(242),n(85),n(69),n(432),n(42),n(722)),m=n(304),l=n(30),d=n.n(l),h=n(77),f=n(738),v=n(907),w=n(20),O=n(29);n(31),n(84),n(113),n(56),n(924),n(431);var I=["","K","M","G","T","P","E","Z","Y"],N=["","m","u","n","p","f","a","z","y"];function y(e,t){var n=(t=t||{}).increment,r=!1!==t.allowFractional;if(!e||"string"!=typeof e||!e.length)return NaN;var o=(e=e.replace(/,/g,"")).match(/^([0-9.-]+)\s*([^0-9.-]?)([^0-9.-]?)/),c=Object(O.a)(o,4),m=c[1],l=c[2],d=c[3],h=parseFloat(m);if(!l)return h;181===l.charCodeAt(0)&&(l="u");var f=N.includes(l),v=I.includes(l.toUpperCase());if(n||(n=(v||f)&&"i"===d?1024:1e3),f&&r){var w=N.indexOf(l);return h/Math.pow(n,w)}if(v){var y=I.indexOf(l.toUpperCase());return h*Math.pow(n,y)}return h}function x(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?x(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):x(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var A={components:{Card:m.Card,Checkbox:m.Checkbox,SortableTable:c.default,ImagesOutputWindow:f.default},props:{images:{type:Array,required:!0},protectedImages:{type:Array,default:function(){return[]}},imageNamespaces:{type:Array,required:!0},selectedNamespace:{type:String,default:"default"},supportsNamespaces:{type:Boolean,default:!1},state:{type:String,default:"IMAGE_MANAGER_UNREADY",validator:function(e){return["IMAGE_MANAGER_UNREADY","READY"].includes(e)}},showAll:{type:Boolean,default:!1}},data:function(){return{currentCommand:null,headers:[{name:"imageName",label:this.t("images.manager.table.header.imageName"),sort:["imageName","tag","imageID"]},{name:"tag",label:this.t("images.manager.table.header.tag"),sort:["tag","imageName","imageID"]},{name:"imageID",label:this.t("images.manager.table.header.imageId"),sort:["imageID","imageName","tag"]},{name:"size",label:this.t("images.manager.table.header.size"),sort:["si","imageName","tag"]}],keepImageManagerOutputWindowOpen:!1,imageOutputCuller:null,mainWindowScroll:-1,selected:[]}},computed:k(k({},Object(h.d)("action-menu",{menuImages:function(e){var t,n;return null!==(t=null===(n=e.resources)||void 0===n?void 0:n.map((function(i){return i.imageName})))&&void 0!==t?t:[]}})),{},{keyedImages:function(){var e=this;return this.images.map((function(image,t){return k(k({},image),{},{si:y(image.size),_key:"".concat(t,"-").concat(image.imageID,"-").concat(e.imageTag(image.tag))})}))},filteredImages:function(){var e=this.keyedImages.filter(this.isNotNoneImage);return!this.supportsShowAll||this.showAll?e:e.filter(this.isDeletable)},imagesToDelete:function(){var e=this;return this.selected.filter((function(image){return e.isDeletable(image)}))},imageIdsToDelete:function(){return this.imagesToDelete.map(this.getTaggedImage)},rows:function(){var e=this;return d.a.cloneDeep(this.filteredImages).map((function(image){return image.availableActions=[{label:e.t("images.manager.table.action.push"),action:"doPush",enabled:e.isPushable(image),icon:"icon icon-upload"},{label:e.t("images.manager.table.action.delete"),action:"deleteImage",enabled:e.isDeletable(image),icon:"icon icon-delete",bulkable:!0,bulkAction:"deleteImages"},{label:e.t("images.manager.table.action.scan"),action:"scanImage",enabled:!0,icon:"icon icon-info"}].filter((function(e){return e.enabled})),image.doPush||(image.doPush=e.doPush.bind(e,image)),image.deleteImage||(image.deleteImage=e.deleteImage.bind(e,image)),image.deleteImages||(image.deleteImages=e.deleteImages.bind(e,image)),image.scanImage||(image.scanImage=e.scanImage.bind(e,image)),image}))},showImageManagerOutput:function(){return this.keepImageManagerOutputWindowOpen},supportsShowAll:function(){return"k8s.io"===this.selectedNamespace}}),watch:{rows:{handler:function(e){this.menuImages.some((function(t){return e.map((function(e){return e.imageName})).includes(t)}))&&this.hideMenu()}}},mounted:function(){this.main=document.getElementsByTagName("main")[0]},methods:k(k({},Object(h.c)("action-menu",{hideMenu:"hide"})),{},{updateSelection:function(e){this.selected=e},startImageManagerOutput:function(){this.keepImageManagerOutputWindowOpen=!0,this.scrollToOutputWindow()},scrollToOutputWindow:function(){var e=this;this.main&&this.$nextTick((function(){e.main.scrollTop=e.main.scrollHeight}))},scrollToTop:function(){var e=this;this.$nextTick((function(){try{e.main.scrollTop=e.mainWindowScroll}catch(t){console.log("Trying to reset scroll to ".concat(e.mainWindowScroll,", got error:"),t)}e.mainWindowScroll=-1}))},startRunningCommand:function(e){this.imageOutputCuller=Object(v.a)(e)},deleteImages:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="Delete ".concat(e.imagesToDelete.length," ").concat(e.imagesToDelete.length>1?"images":"image","?"),r=e.imageIdsToDelete.join("\n"),o={message:n,detail:r,type:"question",buttons:["Yes","No"],defaultId:1,title:"Confirming image deletion",cancelId:1},t.next=5,w.a.invoke("show-message-box",o);case 5:if(1!==t.sent.response){t.next=8;break}return t.abrupt("return");case 8:e.currentCommand="delete ".concat(e.imageIdsToDelete),e.mainWindowScroll=e.main.scrollTop,e.startRunningCommand("delete"),w.a.send("do-image-deletion-batch",e.imageIdsToDelete),e.startImageManagerOutput();case 13:case"end":return t.stop()}}),t)})))()},deleteImage:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={message:"Delete image ".concat(e.imageName,":").concat(e.tag,"?"),type:"question",buttons:["Yes","No"],defaultId:1,title:"Confirming image deletion",cancelId:1},n.next=3,w.a.invoke("show-message-box",r);case 3:if(1!==n.sent.response){n.next=6;break}return n.abrupt("return");case 6:t.currentCommand="delete ".concat(e.imageName,":").concat(e.tag),t.mainWindowScroll=t.main.scrollTop,t.startRunningCommand("delete"),w.a.send("do-image-deletion",e.imageName.trim(),t.getTaggedImage(e)),t.startImageManagerOutput();case 11:case"end":return n.stop()}}),n)})))()},doPush:function(e){this.currentCommand="push ".concat(e.imageName,":").concat(e.tag),this.mainWindowScroll=this.main.scrollTop,this.startRunningCommand("push"),w.a.send("do-image-push",e.imageName.trim(),e.imageID.trim(),e.tag.trim())},scanImage:function(e){var t="".concat(e.imageName.trim(),":").concat(this.imageTag(e.tag));this.$router.push({name:"images-scans-image-name",params:{image:t}})},imageTag:function(e){return"<none>"===e?"latest":"".concat(e.trim())},isNotNoneImage:function(e){return e.imageName&&"<none>"!==e.imageName},isDeletable:function(e){return!this.protectedImages.includes(e.imageName)},isPushable:function(e){return this.isDeletable(e)&&e.imageName.includes("/")},hasDropdownActions:function(e){return this.isDeletable(e)},handleShowAllCheckbox:function(e){this.$emit("toggledShowAll",e)},handleChangeNamespace:function(e){this.$emit("switchNamespace",e.target.value)},resetCurrentCommand:function(){this.currentCommand=null},toggleOutput:function(e){this.keepImageManagerOutputWindowOpen=e,!e&&this.mainWindowScroll>=0&&this.scrollToTop()},getTaggedImage:function(image){return"<none>"!==image.tag?"".concat(image.imageName,":").concat(image.tag):"".concat(image.imageName,"@").concat(image.digest)}})},S=(n(926),n(24)),component=Object(S.a)(A,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["READY"===e.state?n("div",{ref:"fullWindow"},[n("SortableTable",{ref:"imagesTable",staticClass:"imagesTable",attrs:{"data-test":"imagesTableRows","key-field":"_key","default-sort-by":"imageName",headers:e.headers,rows:e.rows,"table-actions":!0,paging:!0},on:{selection:e.updateSelection},scopedSlots:e._u([{key:"header-middle",fn:function(){return[n("div",{staticClass:"header-middle"},[n("Checkbox",{staticClass:"all-images",attrs:{value:e.showAll,label:e.t("images.manager.table.label"),disabled:!e.supportsShowAll},on:{input:e.handleShowAllCheckbox}}),e._v(" "),e.supportsNamespaces?n("div",[n("label",[e._v("Namespace")]),e._v(" "),n("select",{staticClass:"select-namespace",domProps:{value:e.selectedNamespace},on:{change:function(t){return e.handleChangeNamespace(t)}}},e._l(e.imageNamespaces,(function(t){return n("option",{key:t,domProps:{value:t,selected:t===e.selectedNamespace}},[e._v("\n                "+e._s(t)+"\n              ")])})),0)]):e._e()],1)]},proxy:!0}],null,!1,2770331280)}),e._v(" "),e.showImageManagerOutput?n("Card",{attrs:{"show-highlight-border":!1,"show-actions":!1},scopedSlots:e._u([{key:"title",fn:function(){return[n("div",{staticClass:"type-title"},[n("h3",[e._v(e._s(e.t("images.manager.title")))])])]},proxy:!0},{key:"body",fn:function(){return[n("images-output-window",{ref:"image-output-window",attrs:{id:"imageManagerOutput","current-command":e.currentCommand,"image-output-culler":e.imageOutputCuller,"show-status":!1},on:{"ok:process-end":e.resetCurrentCommand,"ok:show":e.toggleOutput}})]},proxy:!0}],null,!1,2602392067)}):e._e()],1):n("div",["IMAGE_MANAGER_UNREADY"===e.state?n("h3",[e._v("\n      "+e._s(e.t("images.state.imagesUnready"))+"\n    ")]):n("h3",[e._v("\n      "+e._s(e.t("images.state.unknown"))+"\n    ")])])])}),[],!1,null,"41a8f148",null);t.default=component.exports},828:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(9),n(171),n(238);var r,o=n(35),c=n(34),m=n(124),l=n(125),d=n(62),h=n(314);n(60),n(53);function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var o=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}!function(e){e.STOPPED="STOPPED",e.STARTING="STARTING",e.STARTED="STARTED",e.STOPPING="STOPPING",e.ERROR="ERROR",e.DISABLED="DISABLED"}(r||(r={}));Error},871:function(e,t,n){var content=n(927);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(67).default)("0861c7c4",content,!0,{sourceMap:!1})},924:function(e,t,n){var r=n(1),o=n(925);r({target:"Number",stat:!0,forced:Number.parseFloat!=o},{parseFloat:o})},925:function(e,t,n){var r=n(5),o=n(3),c=n(4),m=n(38),l=n(311).trim,d=n(312),h=c("".charAt),f=r.parseFloat,v=r.Symbol,w=v&&v.iterator,O=1/f(d+"-0")!=-1/0||w&&!o((function(){f(Object(w))}));e.exports=O?function(e){var t=l(m(e)),n=f(t);return 0===n&&"-"==h(t,0)?-0:n}:f},926:function(e,t,n){"use strict";n(871)},927:function(e,t,n){var r=n(66)(!1);r.push([e.i,'.clearfix[data-v-41a8f148]:after,.clearfix[data-v-41a8f148]:before{content:" ";display:table}.clearfix[data-v-41a8f148]:after{clear:both}.list-unstyled[data-v-41a8f148]{margin:0;padding:0;list-style-type:none}.no-select[data-v-41a8f148]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.no-resize[data-v-41a8f148]{resize:none}.hand[data-v-41a8f148]{cursor:pointer;cursor:hand}.fixed[data-v-41a8f148]{table-layout:fixed}.clip[data-v-41a8f148]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.clip[data-v-41a8f148],.force-wrap[data-v-41a8f148]{word-wrap:break-word}.force-wrap[data-v-41a8f148]{white-space:normal}.bordered-section[data-v-41a8f148]{border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:20px}.section-divider[data-v-41a8f148]{margin-bottom:20px;margin-top:20px}.labeled-input>.btn[data-v-41a8f148]{position:absolute;bottom:-1px;right:-1px;border-start-start-radius:var(--border-radius);border-radius:var(--border-radius) 0 0 0}@keyframes highlightFade-data-v-41a8f148{0%{background:var(--accent-btn)}to{background:transparent}}.select-namespace[data-v-41a8f148]{max-width:24rem;min-width:8rem}.header-middle[data-v-41a8f148]{display:flex;align-items:flex-end;grid-gap:1rem;gap:1rem;height:100%}.all-images[data-v-41a8f148]{margin-bottom:12px}.imagesTable[data-v-41a8f148] .bulk,.imagesTable[data-v-41a8f148] .search-box{align-self:flex-end}',""]),e.exports=r}}]);