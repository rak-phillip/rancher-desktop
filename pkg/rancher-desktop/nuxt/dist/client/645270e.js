(window.webpackJsonp=window.webpackJsonp||[]).push([[29,73],{1066:function(e,t,r){"use strict";r(983)},1067:function(e,t,r){var n=r(66)(!1);n.push([e.i,'.clearfix[data-v-e720c876]:after,.clearfix[data-v-e720c876]:before{content:" ";display:table}.clearfix[data-v-e720c876]:after{clear:both}.list-unstyled[data-v-e720c876]{margin:0;padding:0;list-style-type:none}.no-select[data-v-e720c876]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.no-resize[data-v-e720c876]{resize:none}.hand[data-v-e720c876]{cursor:pointer;cursor:hand}.fixed[data-v-e720c876]{table-layout:fixed}.clip[data-v-e720c876]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.clip[data-v-e720c876],.force-wrap[data-v-e720c876]{word-wrap:break-word}.force-wrap[data-v-e720c876]{white-space:normal}.bordered-section[data-v-e720c876]{border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:20px}.section-divider[data-v-e720c876]{margin-bottom:20px;margin-top:20px}.image-output-container[data-v-e720c876]{padding-bottom:1rem}textarea#imageManagerOutput[data-v-e720c876]{font-family:monospace;font-size:smaller}textarea#imageManagerOutput .failure[data-v-e720c876]{border:2px solid var(--error)}',""]),e.exports=n},1093:function(e,t,r){"use strict";r.r(t);var n=r(8),o=r(315),c=r(94),l=(r(26),r(9),r(246),r(25),r(247),r(22),r(50),r(51),r(52),r(21),r(37),r(40),r(41),r(49),r(42),r(43),r(44),r(45),r(55),r(304)),d=r(738),f=r(762),m=r(727),v=r(907),h=r(20),y=["PkgName","VulnerabilityID"];function w(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}var O={name:"images-scan-details",components:{ImagesScanResults:f.default,ImagesOutputWindow:d.default,Banner:l.Banner,LoadingIndicator:m.default},data:function(){return{image:this.$route.params.image,showImageOutput:!0,imageManagerOutput:"",imageOutputCuller:null,keepImageManagerOutputWindowOpen:!1,currentCommand:null,fieldToClear:"",completionStatus:!1,jsonOutput:"null",postCloseOutputWindowHandler:null}},computed:{isFinishedWithSuccess:function(){return this.isFinished&&this.completionStatus},imageManagerProcessFinishedWithFailure:function(){return this.isFinished&&!this.completionStatus},isFinished:function(){return!this.currentCommand},showImageManagerOutput:function(){return this.keepImageManagerOutputWindowOpen},showOutput:function(){return!this.isFinished&&!this.isFinishedWithSuccess},vulnerabilities:function(){var e,t,r=null===(e=JSON.parse(this.jsonOutput))||void 0===e?void 0:e.Results;return null==r||null===(t=r.reduce((function(e,t){return[].concat(Object(c.a)(e),Object(c.a)((null==t?void 0:t.Vulnerabilities)||[]))}),[]))||void 0===t?void 0:t.map((function(e){var t=e.PkgName,r=e.VulnerabilityID,c=Object(o.a)(e,y);return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?w(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):w(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({id:"".concat(t,"-").concat(r),PkgName:t,VulnerabilityID:r},c)}))},loadingText:function(){return this.t("images.scan.loadingText",{image:this.image},!0)},errorText:function(){return this.t("images.scan.errorText",{image:this.image},!0)}},mounted:function(){var e=this;this.$store.dispatch("page/setHeader",{title:this.t("images.scan.title",{image:this.$route.params.image},!0)}),h.a.on("ok:images-process-output",(function(t,data){e.jsonOutput=data})),this.currentCommand="scan image ".concat(this.image),this.scanImage()},methods:{scanImage:function(){this.startRunningCommand("trivy-image"),h.a.send("do-image-scan",this.image)},startRunningCommand:function(e){this.imageOutputCuller=Object(v.a)(e)},onProcessEnd:function(e){this.completionStatus=e,this.currentCommand=null}}},C=O,_=(r(1066),r(24)),component=Object(_.a)(C,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"image-output-container"},[e.showOutput?r("images-output-window",{attrs:{"current-command":e.currentCommand,"image-output-culler":e.imageOutputCuller},on:{"ok:process-end":e.onProcessEnd},scopedSlots:e._u([{key:"loading",fn:function(t){return[t.isLoading?r("banner",[r("loading-indicator",[e._v("\n          "+e._s(e.loadingText)+"\n        ")])],1):e._e()]}},{key:"error",fn:function(t){var n=t.hasError;return[n?r("banner",{attrs:{color:"error"}},[e._v("\n        "+e._s(n)+"\n        "),r("span",{staticClass:"icon icon-info icon-lg "}),e._v("\n        "+e._s(e.errorText)+"\n      ")]):e._e()]}}],null,!1,1729962750)}):e._e(),e._v(" "),e.isFinished&&e.isFinishedWithSuccess?r("images-scan-results",{attrs:{image:e.image,"table-data":e.vulnerabilities}}):e._e()],1)}),[],!1,null,"e720c876",null);t.default=component.exports},762:function(e,t,r){"use strict";r.r(t);var n=r(8),o=r(315),c=(r(50),r(51),r(52),r(22),r(37),r(9),r(40),r(25),r(41),r(26),r(21),r(49),r(42),r(43),r(44),r(45),r(55),r(722)),l=r(304),d=["Severity"];function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}var m={LOW:{color:"bg-darker",id:0},MEDIUM:{color:"bg-info",id:1},HIGH:{color:"bg-warning",id:2},CRITICAL:{color:"bg-error",id:3}},v={components:{SortableTable:c.default,BadgeState:l.BadgeState},props:{image:{type:String,required:!0},tableData:{type:Array,default:function(){return[]}}},data:function(){return{headers:[{name:"Severity",label:this.t("images.scan.results.headers.severity"),sort:["SeverityId:desc","PkgName","InstalledVersion"]},{name:"PkgName",label:this.t("images.scan.results.headers.package"),sort:["PkgName","Severity","InstalledVersion"]},{name:"VulnerabilityID",label:this.t("images.scan.results.headers.vulnerabilityId"),sort:["VulnerabilityID","Severity","PkgName","InstalledVersion"]},{name:"InstalledVersion",label:this.t("images.scan.results.headers.installed")},{name:"FixedVersion",label:this.t("images.scan.results.headers.fixed")}]}},computed:{rows:function(){var e=this;return this.tableData.map((function(t){var r=t.Severity,c=Object(o.a)(t,d);return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({SeverityId:e.id(r),Severity:r},c)}))},criticalCount:function(){return this.issueCount(m.CRITICAL.id)},criticalLabel:function(){return"".concat(this.t("images.scan.labels.critical"),": ").concat(this.criticalCount)},highCount:function(){return this.issueCount(m.HIGH.id)},highLabel:function(){return"".concat(this.t("images.scan.labels.high"),": ").concat(this.highCount)},mediumCount:function(){return this.issueCount(m.MEDIUM.id)},mediumLabel:function(){return"".concat(this.t("images.scan.labels.medium"),": ").concat(this.mediumCount)},lowCount:function(){return this.issueCount(m.LOW.id)},lowLabel:function(){return"".concat(this.t("images.scan.labels.low"),": ").concat(this.lowCount)},issueSum:function(){return this.criticalCount+this.highCount+this.mediumCount+this.lowCount},issueLabel:function(){return"".concat(this.t("images.scan.labels.issuesFound"),": ").concat(this.issueSum)}},methods:{color:function(e){var t;return null===(t=m[e])||void 0===t?void 0:t.color},id:function(e){var t;return null===(t=m[e])||void 0===t?void 0:t.id},issueCount:function(e){return this.rows.filter((function(t){return t.SeverityId===e})).length}}},h=v,y=(r(954),r(24)),component=Object(y.a)(h,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("sortable-table",{attrs:{headers:e.headers,rows:e.rows,"key-field":"id","default-sort-by":"Severity","table-actions":!1,"row-actions":!1,paging:!0,"sub-rows":!0,"sub-expandable":!0,"sub-expand-column":!0,"rows-per-page":25},scopedSlots:e._u([{key:"header-left",fn:function(){return[r("div",{staticClass:"issue-header"},[e.issueSum?r("badge-state",{attrs:{label:e.issueLabel}}):e._e(),e._v(" "),e.criticalCount?r("badge-state",{attrs:{color:"bg-error",label:e.criticalLabel}}):e._e(),e._v(" "),e.highCount?r("badge-state",{attrs:{color:"bg-warning",label:e.highLabel}}):e._e(),e._v(" "),e.mediumCount?r("badge-state",{attrs:{color:"bg-info",label:e.mediumLabel}}):e._e(),e._v(" "),e.lowCount?r("badge-state",{attrs:{color:"bg-darker",label:e.lowLabel}}):e._e()],1)]},proxy:!0},{key:"col:VulnerabilityID",fn:function(t){var n=t.row;return[r("td",[r("span",[r("a",{attrs:{href:n.PrimaryURL}},[e._v(e._s(n.VulnerabilityID))])])])]}},{key:"col:Severity",fn:function(t){var n=t.row;return[r("td",[r("badge-state",{attrs:{label:n.Severity,color:e.color(n.Severity)}})],1)]}},{key:"sub-row",fn:function(t){var n=t.row,o=t.fullColspan;return[r("td",{staticClass:"sub-row",attrs:{colspan:o}},[r("div",{staticClass:"details"},[r("div",{staticClass:"col description"},[r("section",[r("section",{staticClass:"title"},[e._v("\n              "+e._s(e.t("images.scan.details.description"))+"\n            ")]),e._v("\n            "+e._s(n.Description)+"\n          ")])]),e._v(" "),r("div",{staticClass:"col"},[r("section",[r("section",{staticClass:"title"},[e._v("\n              "+e._s(e.t("images.scan.details.primaryUrl"))+"\n            ")]),e._v(" "),r("a",{attrs:{href:n.PrimaryURL}},[e._v(e._s(n.PrimaryURL))])]),e._v(" "),r("section",[r("section",{staticClass:"title"},[e._v("\n              "+e._s(e.t("images.scan.details.references"))+"\n            ")]),e._v(" "),e._l(n.References,(function(t,n){return r("section",{key:n,staticClass:"reference"},[r("a",{attrs:{href:t}},[e._v(" "+e._s(t)+" ")])])}))],2)])])])]}}])})}),[],!1,null,"72147fd6",null);t.default=component.exports},897:function(e,t,r){var content=r(955);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(67).default)("1a2f2784",content,!0,{sourceMap:!1})},954:function(e,t,r){"use strict";r(897)},955:function(e,t,r){var n=r(66)(!1);n.push([e.i,'.clearfix[data-v-72147fd6]:after,.clearfix[data-v-72147fd6]:before{content:" ";display:table}.clearfix[data-v-72147fd6]:after{clear:both}.list-unstyled[data-v-72147fd6]{margin:0;padding:0;list-style-type:none}.no-select[data-v-72147fd6]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.no-resize[data-v-72147fd6]{resize:none}.hand[data-v-72147fd6]{cursor:pointer;cursor:hand}.fixed[data-v-72147fd6]{table-layout:fixed}.clip[data-v-72147fd6]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.clip[data-v-72147fd6],.force-wrap[data-v-72147fd6]{word-wrap:break-word}.force-wrap[data-v-72147fd6]{white-space:normal}.bordered-section[data-v-72147fd6]{border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:20px}.section-divider[data-v-72147fd6]{margin-bottom:20px;margin-top:20px}.sub-row[data-v-72147fd6]{background-color:var(--body-bg);padding-left:1rem;padding-right:1rem}.details[data-v-72147fd6]{display:grid;grid-auto-flow:column;grid-auto-columns:minmax(0,1fr);grid-gap:1em;gap:1em}.details .col[data-v-72147fd6]{display:flex;flex-direction:column}.details .col section[data-v-72147fd6]{margin-bottom:1.5rem}.details .col .reference[data-v-72147fd6],.details .col .title[data-v-72147fd6]{margin-bottom:.5rem}.details .col .reference a[data-v-72147fd6]{word-wrap:break-word}.details .col .title[data-v-72147fd6]{color:var(--muted)}.issue-header[data-v-72147fd6]{display:flex;grid-gap:.25rem;gap:.25rem}',""]),e.exports=n},983:function(e,t,r){var content=r(1067);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(67).default)("5d31c403",content,!0,{sourceMap:!1})}}]);