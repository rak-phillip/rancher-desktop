(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{750:function(e,t,n){"use strict";n.r(t);n(26),n(21),n(49),n(43),n(44),n(45),n(55);var r=n(2),o=n(8),l=(n(27),n(78),n(50),n(51),n(52),n(22),n(37),n(9),n(40),n(25),n(41),n(241),n(242),n(85),n(69),n(432),n(42),n(722)),c=n(304),m=n(30),d=n.n(m),f=n(77),h=n(738),v=n(907),w=n(20),I=n(29);n(31),n(84),n(113),n(56),n(924),n(431);var y=["","K","M","G","T","P","E","Z","Y"],N=["","m","u","n","p","f","a","z","y"];function O(e,t){var n=(t=t||{}).increment,r=!1!==t.allowFractional;if(!e||"string"!=typeof e||!e.length)return NaN;var o=(e=e.replace(/,/g,"")).match(/^([0-9.-]+)\s*([^0-9.-]?)([^0-9.-]?)/),l=Object(I.a)(o,4),c=l[1],m=l[2],d=l[3],f=parseFloat(c);if(!m)return f;181===m.charCodeAt(0)&&(m="u");var h=N.includes(m),v=y.includes(m.toUpperCase());if(n||(n=(v||h)&&"i"===d?1024:1e3),h&&r){var w=N.indexOf(m);return f/Math.pow(n,w)}if(v){var O=y.indexOf(m.toUpperCase());return f*Math.pow(n,O)}return f}function x(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?x(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):x(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var C={components:{Card:c.Card,Checkbox:c.Checkbox,SortableTable:l.default,ImagesOutputWindow:h.default},props:{images:{type:Array,required:!0},protectedImages:{type:Array,default:function(){return[]}},imageNamespaces:{type:Array,required:!0},selectedNamespace:{type:String,default:"default"},supportsNamespaces:{type:Boolean,default:!1},state:{type:String,default:"IMAGE_MANAGER_UNREADY",validator:function(e){return["IMAGE_MANAGER_UNREADY","READY"].includes(e)}},showAll:{type:Boolean,default:!1}},data:function(){return{currentCommand:null,headers:[{name:"imageName",label:this.t("images.manager.table.header.imageName"),sort:["imageName","tag","imageID"]},{name:"tag",label:this.t("images.manager.table.header.tag"),sort:["tag","imageName","imageID"]},{name:"imageID",label:this.t("images.manager.table.header.imageId"),sort:["imageID","imageName","tag"]},{name:"size",label:this.t("images.manager.table.header.size"),sort:["si","imageName","tag"]}],keepImageManagerOutputWindowOpen:!1,imageOutputCuller:null,mainWindowScroll:-1,selected:[]}},computed:k(k({},Object(f.d)("action-menu",{menuImages:function(e){var t,n;return null!==(t=null===(n=e.resources)||void 0===n?void 0:n.map((function(i){return i.imageName})))&&void 0!==t?t:[]}})),{},{keyedImages:function(){var e=this;return this.images.map((function(image,t){return k(k({},image),{},{si:O(image.size),_key:"".concat(t,"-").concat(image.imageID,"-").concat(e.imageTag(image.tag))})}))},filteredImages:function(){var e=this.keyedImages.filter(this.isNotNoneImage);return!this.supportsShowAll||this.showAll?e:e.filter(this.isDeletable)},imagesToDelete:function(){var e=this;return this.selected.filter((function(image){return e.isDeletable(image)}))},imageIdsToDelete:function(){return this.imagesToDelete.map(this.getTaggedImage)},rows:function(){var e=this;return d.a.cloneDeep(this.filteredImages).map((function(image){return image.availableActions=[{label:e.t("images.manager.table.action.push"),action:"doPush",enabled:e.isPushable(image),icon:"icon icon-upload"},{label:e.t("images.manager.table.action.delete"),action:"deleteImage",enabled:e.isDeletable(image),icon:"icon icon-delete",bulkable:!0,bulkAction:"deleteImages"},{label:e.t("images.manager.table.action.scan"),action:"scanImage",enabled:!0,icon:"icon icon-info"}].filter((function(e){return e.enabled})),image.doPush||(image.doPush=e.doPush.bind(e,image)),image.deleteImage||(image.deleteImage=e.deleteImage.bind(e,image)),image.deleteImages||(image.deleteImages=e.deleteImages.bind(e,image)),image.scanImage||(image.scanImage=e.scanImage.bind(e,image)),image}))},showImageManagerOutput:function(){return this.keepImageManagerOutputWindowOpen},supportsShowAll:function(){return"k8s.io"===this.selectedNamespace}}),watch:{rows:{handler:function(e){this.menuImages.some((function(t){return e.map((function(e){return e.imageName})).includes(t)}))&&this.hideMenu()}}},mounted:function(){this.main=document.getElementsByTagName("main")[0]},methods:k(k({},Object(f.c)("action-menu",{hideMenu:"hide"})),{},{updateSelection:function(e){this.selected=e},startImageManagerOutput:function(){this.keepImageManagerOutputWindowOpen=!0,this.scrollToOutputWindow()},scrollToOutputWindow:function(){var e=this;this.main&&this.$nextTick((function(){e.main.scrollTop=e.main.scrollHeight}))},scrollToTop:function(){var e=this;this.$nextTick((function(){try{e.main.scrollTop=e.mainWindowScroll}catch(t){console.log("Trying to reset scroll to ".concat(e.mainWindowScroll,", got error:"),t)}e.mainWindowScroll=-1}))},startRunningCommand:function(e){this.imageOutputCuller=Object(v.a)(e)},deleteImages:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="Delete ".concat(e.imagesToDelete.length," ").concat(e.imagesToDelete.length>1?"images":"image","?"),r=e.imageIdsToDelete.join("\n"),o={message:n,detail:r,type:"question",buttons:["Yes","No"],defaultId:1,title:"Confirming image deletion",cancelId:1},t.next=5,w.a.invoke("show-message-box",o);case 5:if(1!==t.sent.response){t.next=8;break}return t.abrupt("return");case 8:e.currentCommand="delete ".concat(e.imageIdsToDelete),e.mainWindowScroll=e.main.scrollTop,e.startRunningCommand("delete"),w.a.send("do-image-deletion-batch",e.imageIdsToDelete),e.startImageManagerOutput();case 13:case"end":return t.stop()}}),t)})))()},deleteImage:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={message:"Delete image ".concat(e.imageName,":").concat(e.tag,"?"),type:"question",buttons:["Yes","No"],defaultId:1,title:"Confirming image deletion",cancelId:1},n.next=3,w.a.invoke("show-message-box",r);case 3:if(1!==n.sent.response){n.next=6;break}return n.abrupt("return");case 6:t.currentCommand="delete ".concat(e.imageName,":").concat(e.tag),t.mainWindowScroll=t.main.scrollTop,t.startRunningCommand("delete"),w.a.send("do-image-deletion",e.imageName.trim(),t.getTaggedImage(e)),t.startImageManagerOutput();case 11:case"end":return n.stop()}}),n)})))()},doPush:function(e){this.currentCommand="push ".concat(e.imageName,":").concat(e.tag),this.mainWindowScroll=this.main.scrollTop,this.startRunningCommand("push"),w.a.send("do-image-push",e.imageName.trim(),e.imageID.trim(),e.tag.trim())},scanImage:function(e){var t="".concat(e.imageName.trim(),":").concat(this.imageTag(e.tag));this.$router.push({name:"images-scans-image-name",params:{image:t}})},imageTag:function(e){return"<none>"===e?"latest":"".concat(e.trim())},isNotNoneImage:function(e){return e.imageName&&"<none>"!==e.imageName},isDeletable:function(e){return!this.protectedImages.includes(e.imageName)},isPushable:function(e){return this.isDeletable(e)&&e.imageName.includes("/")},hasDropdownActions:function(e){return this.isDeletable(e)},handleShowAllCheckbox:function(e){this.$emit("toggledShowAll",e)},handleChangeNamespace:function(e){this.$emit("switchNamespace",e.target.value)},resetCurrentCommand:function(){this.currentCommand=null},toggleOutput:function(e){this.keepImageManagerOutputWindowOpen=e,!e&&this.mainWindowScroll>=0&&this.scrollToTop()},getTaggedImage:function(image){return"<none>"!==image.tag?"".concat(image.imageName,":").concat(image.tag):"".concat(image.imageName,"@").concat(image.digest)}})},T=(n(926),n(24)),component=Object(T.a)(C,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["READY"===e.state?n("div",{ref:"fullWindow"},[n("SortableTable",{ref:"imagesTable",staticClass:"imagesTable",attrs:{"data-test":"imagesTableRows","key-field":"_key","default-sort-by":"imageName",headers:e.headers,rows:e.rows,"table-actions":!0,paging:!0},on:{selection:e.updateSelection},scopedSlots:e._u([{key:"header-middle",fn:function(){return[n("div",{staticClass:"header-middle"},[n("Checkbox",{staticClass:"all-images",attrs:{value:e.showAll,label:e.t("images.manager.table.label"),disabled:!e.supportsShowAll},on:{input:e.handleShowAllCheckbox}}),e._v(" "),e.supportsNamespaces?n("div",[n("label",[e._v("Namespace")]),e._v(" "),n("select",{staticClass:"select-namespace",domProps:{value:e.selectedNamespace},on:{change:function(t){return e.handleChangeNamespace(t)}}},e._l(e.imageNamespaces,(function(t){return n("option",{key:t,domProps:{value:t,selected:t===e.selectedNamespace}},[e._v("\n                "+e._s(t)+"\n              ")])})),0)]):e._e()],1)]},proxy:!0}],null,!1,2770331280)}),e._v(" "),e.showImageManagerOutput?n("Card",{attrs:{"show-highlight-border":!1,"show-actions":!1},scopedSlots:e._u([{key:"title",fn:function(){return[n("div",{staticClass:"type-title"},[n("h3",[e._v(e._s(e.t("images.manager.title")))])])]},proxy:!0},{key:"body",fn:function(){return[n("images-output-window",{ref:"image-output-window",attrs:{id:"imageManagerOutput","current-command":e.currentCommand,"image-output-culler":e.imageOutputCuller,"show-status":!1},on:{"ok:process-end":e.resetCurrentCommand,"ok:show":e.toggleOutput}})]},proxy:!0}],null,!1,2602392067)}):e._e()],1):n("div",["IMAGE_MANAGER_UNREADY"===e.state?n("h3",[e._v("\n      "+e._s(e.t("images.state.imagesUnready"))+"\n    ")]):n("h3",[e._v("\n      "+e._s(e.t("images.state.unknown"))+"\n    ")])])])}),[],!1,null,"41a8f148",null);t.default=component.exports},871:function(e,t,n){var content=n(927);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(67).default)("0861c7c4",content,!0,{sourceMap:!1})},924:function(e,t,n){var r=n(1),o=n(925);r({target:"Number",stat:!0,forced:Number.parseFloat!=o},{parseFloat:o})},925:function(e,t,n){var r=n(5),o=n(3),l=n(4),c=n(38),m=n(311).trim,d=n(312),f=l("".charAt),h=r.parseFloat,v=r.Symbol,w=v&&v.iterator,I=1/h(d+"-0")!=-1/0||w&&!o((function(){h(Object(w))}));e.exports=I?function(e){var t=m(c(e)),n=h(t);return 0===n&&"-"==f(t,0)?-0:n}:h},926:function(e,t,n){"use strict";n(871)},927:function(e,t,n){var r=n(66)(!1);r.push([e.i,'.clearfix[data-v-41a8f148]:after,.clearfix[data-v-41a8f148]:before{content:" ";display:table}.clearfix[data-v-41a8f148]:after{clear:both}.list-unstyled[data-v-41a8f148]{margin:0;padding:0;list-style-type:none}.no-select[data-v-41a8f148]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.no-resize[data-v-41a8f148]{resize:none}.hand[data-v-41a8f148]{cursor:pointer;cursor:hand}.fixed[data-v-41a8f148]{table-layout:fixed}.clip[data-v-41a8f148]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.clip[data-v-41a8f148],.force-wrap[data-v-41a8f148]{word-wrap:break-word}.force-wrap[data-v-41a8f148]{white-space:normal}.bordered-section[data-v-41a8f148]{border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:20px}.section-divider[data-v-41a8f148]{margin-bottom:20px;margin-top:20px}.labeled-input>.btn[data-v-41a8f148]{position:absolute;bottom:-1px;right:-1px;border-start-start-radius:var(--border-radius);border-radius:var(--border-radius) 0 0 0}@keyframes highlightFade-data-v-41a8f148{0%{background:var(--accent-btn)}to{background:transparent}}.select-namespace[data-v-41a8f148]{max-width:24rem;min-width:8rem}.header-middle[data-v-41a8f148]{display:flex;align-items:flex-end;grid-gap:1rem;gap:1rem;height:100%}.all-images[data-v-41a8f148]{margin-bottom:12px}.imagesTable[data-v-41a8f148] .bulk,.imagesTable[data-v-41a8f148] .search-box{align-self:flex-end}',""]),e.exports=r}}]);